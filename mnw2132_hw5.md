p8105_hw5_mnw2132
================
Mary Williams
2024-11-15

# Set up

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.5
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.1
    ## ✔ ggplot2   3.5.1     ✔ tibble    3.2.1
    ## ✔ lubridate 1.9.3     ✔ tidyr     1.3.1
    ## ✔ purrr     1.0.2     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library(ggplot2)
library(rvest)
```

    ## 
    ## Attaching package: 'rvest'
    ## 
    ## The following object is masked from 'package:readr':
    ## 
    ##     guess_encoding

``` r
library(broom)
```

# Problem 1

### Create the function

``` r
#Create the function
birthday_data<-function(sample_size) {
  bday<- sample(1:365, sample_size, replace = TRUE)
  any(duplicated(bday))
}
```

``` r
# Run the function
sim_bday= 
  tibble(
    sample_size = 2:50) %>%
  mutate(
    output_lists = map(.x = sample_size, ~rerun(10000, birthday_data(.x))), 
    estimate_df= map_dbl(output_lists, ~mean(unlist(.)))
) %>%
  select(sample_size, estimate_df)
```

    ## Warning: There was 1 warning in `mutate()`.
    ## ℹ In argument: `output_lists = map(.x = sample_size, ~rerun(10000,
    ##   birthday_data(.x)))`.
    ## Caused by warning:
    ## ! `rerun()` was deprecated in purrr 1.0.0.
    ## ℹ Please use `map()` instead.
    ##   # Previously
    ##   rerun(10000, birthday_data(.x))
    ## 
    ##   # Now
    ##   map(1:10000, ~ birthday_data(.x))

### Graph the function

``` r
sim_bday %>%
  ggplot(aes(x = sample_size, y = estimate_df)) +   geom_line(color = "light pink") +  geom_point(color = "red") + 
  labs(
    x = "Sample Size",
    y = "Probability of Duplicate Birthday",
    title = "Probability that ≥2 Share a Birthday") + 
theme_minimal()
```

![](mnw2132_hw5_files/figure-gfm/unnamed-chunk-3-1.png)<!-- -->

# Problem 2

``` r
set.seed(1)

#Create the function 
t_test = function(n = 30, mu = 0, sigma = 5) {
  sim_test = tibble(
    x = rnorm(n, mean = mu, sd = sigma))
  
  test_result = t.test(sim_test$x, mu = 0)
  tidy_result = tidy(test_result)
  
  tibble(
    mu_hat = mean(sim_test$x),
    p_value = tidy_result$p.value
  )
}

t_test(30)
```

    ## # A tibble: 1 × 2
    ##   mu_hat p_value
    ##    <dbl>   <dbl>
    ## 1  0.412   0.629

``` r
sim_results = map_dfr(c(0, 1, 2, 3, 4, 5, 6), function(mu) {
  map_dfr(1:5000, ~ t_test(n = 30, mu = mu, sigma = 5)) %>%
  mutate(true_mu = mu)
})
```

``` r
results_df = bind_rows(sim_results)
```

## Plot 1: Plot of power vs True mean

``` r
plot_1 = results_df %>%
  group_by(true_mu) %>%
  summarize(power = mean(p_value < 0.05))

ggplot(plot_1, aes(x = true_mu, y = power)) +
  geom_point(color = "red") + 
  geom_line(color = "pink") + 
  labs(x = "mu", 
       y = "Power", 
    title = "Power vs Effect Size")
```

![](mnw2132_hw5_files/figure-gfm/unnamed-chunk-7-1.png)<!-- -->

## Plot of mu_hat vs true mean

``` r
average_mu_hat = results_df %>%
  group_by(true_mu) %>%
  summarize(average_mu_hat = mean(mu_hat))

ggplot(average_mu_hat, aes(x = true_mu, y = average_mu_hat)) +
  geom_point(color = "red") +
  geom_line(color = "pink") +
  labs(x = "True Mean (Mu)",
       y = "Average mu_hat",
       title = "Average mu_hat vs True Mean")
```

![](mnw2132_hw5_files/figure-gfm/unnamed-chunk-8-1.png)<!-- -->
